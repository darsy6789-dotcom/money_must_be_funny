<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–ö–ê–†–¢–û–ß–ù–ê–Ø –ò–ì–†–ê ‚ÄúMONEY MUST BE FUNNY‚Äù</title>
  <style>
    /* ===== –¢–ï–ú–ê (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ) ===== */
    :root{
      --page-bg: linear-gradient(rgba(255,255,255,.35), rgba(255,255,255,.35)),
                 url("./money-fire.png") center/cover no-repeat fixed;
      --text:#333;
      --card-bg: rgba(255,255,255,.88);
      --card-border:#ccc;
      --back-bg: rgba(234,234,234,.88);
      --pill-bg:#111;
      --headline-bg:#111; --headline-border:#000; --headline-text:#fff;
      --button-primary:#4CAF50; --button-primary-hover:#45a049;
      --modal-backdrop: rgba(0,0,0,.35);
      --menu-btn-bg:#000; --menu-btn-border:#000; --menu-btn-text:#fff;
      --qt-bg:#f2f2f2; --qt-border:#cfcfcf; --qt-knob:#fff;
      --qt-sun:#ffb300; --qt-moon:#9bbcff;
    }
    body.dark{
      --page-bg: linear-gradient(rgba(255,255,255,.35), rgba(255,255,255,.35)),
                 url("./money-fire-night.png") center/cover no-repeat fixed;
      --text:#eee;
      --card-bg: rgba(20,20,20,.95);
      --card-border:#3a3a3a;
      --back-bg: rgba(30,30,30,.95);
      --pill-bg:#000;
      --headline-bg:#000; --headline-border:#000; --headline-text:#fff;
      --button-primary:#278f3a; --button-primary-hover:#1f7c31;
      --modal-backdrop: rgba(0,0,0,.65);
      --menu-btn-bg:#111; --menu-btn-border:#000; --menu-btn-text:#fff;
    }

    /* ===== –ë–ê–ó–ê ===== */
    body{
      margin:0; min-height:100vh; display:flex; flex-direction:column; align-items:center;
      padding:40px; font-family:sans-serif;
      background:var(--page-bg); color:var(--text);
    }
    .game-title{
      margin:0 0 14px 0; padding:10px 16px; display:inline-block;
      font-size:44px; font-weight:800; color:var(--headline-text);
      background:var(--headline-bg); border:2px solid var(--headline-border); border-radius:14px;
    }
    .rules{ font-size:16px; max-width:720px; text-align:center; margin-bottom:8px; }

    #progress{
      font-size:14px; font-weight:700; color:#fff;
      background:var(--pill-bg); padding:6px 12px; border-radius:999px;
      display:inline-block; margin:6px 0 12px;
    }

    #card-container{ width:100%; display:flex; gap:16px; flex-wrap:wrap; justify-content:center; align-items:stretch; min-height:190px; }

    /* flip-–∫–∞—Ä—Ç–æ—á–∫–∞ */
    .card{ width:280px; height:180px; cursor:pointer; display:block; border-radius:12px; }
    .card-inner{ position:relative; width:100%; height:100%; }
    .card-front, .card-back{
      position:absolute; inset:0; display:flex; align-items:center; justify-content:center;
      font-size:18px; padding:10px; box-sizing:border-box;
      border-radius:12px; border:1px solid var(--card-border); text-align:center;
      background:var(--card-bg);
    }
    .card-front{ font-weight:700; letter-spacing:.3px; text-transform:uppercase; }
    .card-back{ background:var(--back-bg); font-style:italic; }

    .card .card-back{ display:none; }
    .card.flipped .card-front{ display:none; }
    .card.flipped .card-back{ display:flex; }

    @supports ((transform-style: preserve-3d) and (backface-visibility: hidden)) {
      .card{ perspective:1000px; }
      .card-inner{ transform-style:preserve-3d; transition:transform .6s; }
      .card.flipped .card-inner{ transform:rotateY(180deg); }
      .card-front, .card-back{ backface-visibility:hidden; display:flex; }
      .card-back{ transform:rotateY(180deg); }
    }

    .card-static{
      width:320px; min-height:180px; display:flex; flex-direction:column; gap:8px;
      padding:14px; border-radius:12px; border:1px solid var(--card-border);
      background:var(--card-bg); box-sizing:border-box;
    }
    .card-title{ font-weight:600; font-size:18px; }
    .card-text{ font-size:16px; line-height:1.35; }

    .buttons{ margin-top:20px; display:flex; gap:10px; }
    .btn-nav{
      display:flex; align-items:center; gap:8px;
      padding:12px 18px; font-size:18px; font-weight:600;
      border:none; border-radius:10px; background:var(--button-primary); color:#fff; cursor:pointer;
      transition:background .15s ease;
    }
    .btn-nav:hover{ background:var(--button-primary-hover); }

    /* –ª–æ–∫–∞–ª—å–Ω—ã–π back –¥–ª—è split */
    #split-header{ display:flex; justify-content:center; margin:10px 0; }
    .split-hidden{ display:none !important; }
    .split-back-btn{
      padding:6px 12px; font-size:14px; border:1px solid var(--card-border);
      border-radius:8px; background:var(--back-bg); color:var(--text); cursor:pointer;
    }
    .split-back-btn:hover{ filter:brightness(.95); }
  </style>
</head>
<body>

<h1 class="game-title">–ö–ê–†–¢–û–ß–ù–ê–Ø –ò–ì–†–ê ‚ÄúMONEY MUST BE FUNNY‚Äù</h1>
<div class="rules">
  –ù–∞–∂–∏–º–∞–π –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫—É, —á—Ç–æ–±—ã –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏–π.<br>
  –¢–≤–æ—è –∑–∞–¥–∞—á–∞ ‚Äî –º–æ–Ω–µ—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç.
</div>

<div id="progress" aria-live="polite"></div>

<!-- –õ–æ–∫–∞–ª—å–Ω—ã–π back –¥–ª—è split -->
<div id="split-header" class="split-hidden">
  <button id="split-back" type="button" class="split-back-btn">
    ‚Üê –ù–∞–∑–∞–¥ –∫ ¬´<span id="split-title"></span>¬ª
  </button>
</div>

<div id="card-container"></div>

<div class="buttons">
  <button id="prev-btn" type="button" class="btn-nav">–ù–∞–∑–∞–¥</button>
  <button id="next-btn" type="button" class="btn-nav">–í–ø–µ—Ä—ë–¥</button>
</div>

<!-- –ú–∏–Ω–∏-—Ç—É–º–±–ª–µ—Ä —Ç–µ–º—ã -->
<div id="theme-toggle-container">
  <button id="theme-toggle">üåû / üåô</button>
</div>

<script>
(function(){
  var cardsData = [
    { type:'single', front:'–ó–µ–º–ª—è',  back:'–†–µ—Å—É—Ä—Å—ã, —Å–µ–ª—å—Å–∫–æ–µ —Ö–æ–∑—è–π—Å—Ç–≤–æ, –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å' },
    { type:'single', front:'–í–æ–¥–∞',   back:'–ü—Ä–æ–¥–∞–∂–∞ –ø–∏—Ç—å–µ–≤–æ–π –≤–æ–¥—ã, –≥–∏–¥—Ä–æ—ç–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞, —Ç—É—Ä–∏–∑–º' },
    { type:'single', front:'–í–æ–∑–¥—É—Ö', back:'–¢—É—Ä–∏–∑–º, –≤–æ–∑–¥—É—Ö –≤ –±–∞–ª–ª–æ–Ω–∞—Ö, —Ä–µ–∫–ª–∞–º–∞ –Ω–∞ –≤–æ–∑–¥—É—à–Ω—ã—Ö —à–∞—Ä–∞—Ö' },
    { type:'single', front:'–û–≥–æ–Ω—å',  back:'–≠–Ω–µ—Ä–≥–µ—Ç–∏–∫–∞, –æ–±–æ–≥—Ä–µ–≤, –∫—É–ª–∏–Ω–∞—Ä–∏—è' },
    { type:'multi',  front:'–ë–ª—ë—Å—Ç–∫–∏',
      labels:['–ö–æ—Å–º–µ—Ç–∏–∫–∞','–û–¥–µ–∂–¥–∞'],
      texts:['–ö–æ—Å–º–µ—Ç–∏–∫–∞: —Ç–µ–Ω–∏, –ª–∞–∫–∏.','–û–¥–µ–∂–¥–∞: —Ç–∫–∞–Ω–∏ —Å –±–ª—ë—Å—Ç–∫–∞–º–∏.'] }
  ];
  cardsData.sort((a,b)=>a.front.localeCompare(b.front,'ru'));
  var visible = new Set(cardsData.map(c=>c.front));
  var currentIndex=0;
  var container=document.getElementById('card-container');
  var progress=document.getElementById('progress');

  // split header
  var splitHeader = document.getElementById('split-header');
  var splitTitle  = document.getElementById('split-title');
  var splitBack   = document.getElementById('split-back');
  function isSplitOpen(){ return !splitHeader.classList.contains('split-hidden'); }
  function openSplit(title){ splitTitle.textContent=title; splitHeader.classList.remove('split-hidden'); }
  function closeSplit(){ splitHeader.classList.add('split-hidden'); }

  function getFiltered(){ return cardsData.filter(c=>visible.has(c.front)); }

  function createFlipCard(frontText, backText){
    var wrapper=document.createElement('div'); wrapper.className='card';
    var inner=document.createElement('div'); inner.className='card-inner';
    var front=document.createElement('div'); front.className='card-front'; front.textContent=frontText.toUpperCase();
    var back=document.createElement('div'); back.className='card-back'; back.textContent=backText||'';
    inner.appendChild(front); inner.appendChild(back); wrapper.appendChild(inner);
    wrapper.onclick=function(){ wrapper.classList.toggle('flipped'); };
    return wrapper;
  }
  function createInfoCard(title,text){
    var box=document.createElement('div'); box.className='card-static';
    var t=document.createElement('div'); t.className='card-title'; t.textContent=title;
    var d=document.createElement('div'); d.className='card-text'; d.textContent=text;
    box.appendChild(t); box.appendChild(d); return box;
  }
  function createMultiFrontCard(title,onOpen){
    var wrapper=document.createElement('div'); wrapper.className='card';
    var inner=document.createElement('div'); inner.className='card-inner';
    var front=document.createElement('div'); front.className='card-front'; front.textContent=title.toUpperCase();
    var back=document.createElement('div'); back.className='card-back'; back.textContent='';
    inner.appendChild(front); inner.appendChild(back); wrapper.appendChild(inner);
    wrapper.onclick=function(){ if(onOpen) onOpen(); };
    return wrapper;
  }

  function renderSingle(item){
    closeSplit();
    container.innerHTML='';
    container.appendChild(createFlipCard(item.front,item.back));
  }
  function renderMultiFront(item){
    closeSplit();
    container.innerHTML='';
    container.appendChild(createMultiFrontCard(item.front,function(){ renderMultiSplit(item); }));
  }
  function renderMultiSplit(item){
    openSplit(item.front);
    container.innerHTML='';
    container.appendChild(createInfoCard(item.labels[0], item.texts[0]));
    container.appendChild(createInfoCard(item.labels[1], item.texts[1]));
  }

  function render(){
    var list=getFiltered();
    if(list.length===0){ container.innerHTML='–ü—É—Å—Ç–æ'; progress.textContent='0/0'; return; }
    currentIndex=((currentIndex%list.length)+list.length)%list.length;
    var item=list[currentIndex];
    if(item.type==='single') renderSingle(item);
    else renderMultiFront(item);
    progress.textContent=(currentIndex+1)+' / '+list.length;
  }

  // –ª–æ–∫–∞–ª—å–Ω—ã–π back
  if(splitBack){
    splitBack.addEventListener('click',function(){
      var list=getFiltered(); var item=list[currentIndex];
      if(item && item.type==='multi') renderMultiFront(item);
    });
  }

  // –∫–Ω–æ–ø–∫–∏
  document.getElementById('next-btn').onclick=function(){
    var len=getFiltered().length||1;
    currentIndex=(currentIndex+1)%len;
    render();
  };
  document.getElementById('prev-btn').onclick=function(){
    var list=getFiltered(); var item=list[currentIndex];
    if(item && item.type==='multi' && isSplitOpen()){ renderMultiFront(item); return; }
    var len=list.length||1; currentIndex=(currentIndex-1+len)%len; render();
  };

  // –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
  document.addEventListener('keydown',function(e){
    if(e.key==='ArrowLeft'||e.key==='a'||e.key==='A'){
      var list=getFiltered(); var item=list[currentIndex];
      if(item && item.type==='multi' && isSplitOpen()){ renderMultiFront(item); }
      else{ var len=list.length||1; currentIndex=(currentIndex-1+len)%len; render(); }
      e.preventDefault(); return;
    }
    if(e.key==='ArrowRight'||e.key==='d'||e.key==='D'){
      var len=getFiltered().length||1; currentIndex=(currentIndex+1)%len; render(); e.preventDefault(); return;
    }
  });

  // —Ç—É–º–±–ª–µ—Ä —Ç–µ–º—ã
  document.getElementById('theme-toggle').onclick=function(){
    document.body.classList.toggle('dark');
  };

  render();
})();
</script>
</body>
</html>
